       IDENTIFICATION DIVISION.
       PROGRAM-ID.    TESTCMP4.
       AUTHOR.        DON HIGGINS.
       DATE-WRITTEN.  05/07/12.
      * TEST COMPUTE WITH SCALING FOR IMPLIED DECIMAL                              
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       77 H1      COMP PIC S9(3)V9       VALUE 1.5.
       77 F1      COMP PIC S9(7)V99      VALUE 1.5.
       77 G1      COMP PIC S9(15)V999    VALUE 1.5.
       77 Q1      COMP PIC S9(35)V9(4)   VALUE 1.5.
       77 P1      COMP-3 PIC S9(26)V9(5) VALUE 1.5.
       77 Z1             PIC S9(25)V9(6) VALUE 1.5.
       77 H2      COMP PIC S9(3)V9       VALUE 1.5.
       77 F2      COMP PIC S9(7)V99      VALUE 1.5.
       77 G2      COMP PIC S9(15)V999    VALUE 1.5.
       77 Q2      COMP PIC S9(35)V9(4)   VALUE 1.5.
       77 P2      COMP-3 PIC S9(26)V9(5) VALUE 1.5.
       77 Z2             PIC S9(25)V9(6) VALUE 1.5.
       77 LD2 FLOAT-DECIMAL-34  VALUE 1.0.
       77 GOOD    COMP-3 PIC 9(4)   VALUE 0.
       77 BAD     COMP-3 PIC 9(4)   VALUE 0.
       PROCEDURE DIVISION.
       MAINLINE.
           DISPLAY 'TESTCMP4 TEST SCALED COMPUTE'
           COMPUTE Z2 = 1.5
           IF Z2 = 1.5  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = H1
           IF Z2 = 1.5  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = 1.5 + 1.5
           IF Z2 = 3    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = 1.5 - 1.5
           IF Z2 = 0    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = 1.5 * 1.5
           IF Z2 = 2.25 PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = 1.5 / 1.5
           IF Z2 = 1    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE H2 = 1111 + 2222
           IF H2 = 3333 PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE F2 = 111111111 + 222222222
           IF F2 = 333333333 PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE LD2 = 111111111111111.111
           COMPUTE G2  = LD2 + LD2
           COMPUTE LD2 = LD2 + LD2
           IF G2 = LD2  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE LD2 = 1111111111111111111111111111111.1111
           COMPUTE Q2  = LD2 + LD2
           COMPUTE LD2 = LD2 + LD2
           IF Q2 = LD2  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE LD2 = 11111111111111111111111111.11111
           COMPUTE P2  = LD2 + LD2
           COMPUTE LD2 = LD2 + LD2
           IF P2 = LD2  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE LD2 = 1111111111111111111111111.111111
           COMPUTE Z2  = LD2 + LD2
           COMPUTE LD2 = LD2 + LD2
           IF Z2 = LD2  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = H1+F1+G1+Q1+P1+Z1
           IF Z2 = 9    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = Z1+P1+Q1+G1+F1+H1
           IF Z2 = 9    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = (H1 -F1)+(G1 -Q1)+(P1 -Z1)
           IF Z2 = 0    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = H1*F1+G1*Q1+P1*Z1
           IF Z2 = 6.75 PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = H1/F1+G1/Q1
           IF Z2 = 2    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE H2 = H1+H1
           IF H2 = 3    PERFORM GOOD ELSE PERFORM BAD..
           COMPUTE F2 = F1+F1
           IF F2 = 3    PERFORM GOOD ELSE PERFORM BAD..
           COMPUTE G2 = G1+G1
           IF G2 = 3    PERFORM GOOD ELSE PERFORM BAD..
           COMPUTE Q2 = Q1+Q1
           IF Q2 = 3    PERFORM GOOD ELSE PERFORM BAD..
           COMPUTE P2 = P1+P1
           IF P2 = 3    PERFORM GOOD ELSE PERFORM BAD..
           COMPUTE Z2 = Z1+Z1
           IF Z2 = 3    PERFORM GOOD ELSE PERFORM BAD..
           COMPUTE H2 = H1 -H1
           IF H2 = 0    PERFORM GOOD ELSE PERFORM BAD..
           COMPUTE F2 = F1 -F1
           IF F2 = 0    PERFORM GOOD ELSE PERFORM BAD..
           COMPUTE G2 = G1 -G1
           IF G2 = 0    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Q2 = Q1 -Q1
           IF Q2 = 0    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE P2 = P1 -P1
           IF P2 = 0    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = Z1 -Z1
           IF Z2 = 0    PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE H2 = H1*H1
           IF H2 = 2.2  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE F2 = F1*F1
           IF F2 = 2.25 PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE G2 = G1*G1
           IF G2 = 2.25 PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Q2 = Q1*Q1
           IF Q2 = 2.25 PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE P2 = P1*P1
           IF P2 = 2.25 PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = Z1*Z1
           IF Z2 = 2.25 PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE H2 = H1/H1
           IF H2 = 1.0  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE F2 = F1/F1
           IF F2 = 1.0  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE G2 = G1/G1
           IF G2 = 1.0  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Q2 = Q1/Q1
           IF Q2 = 1.0  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE P2 = P1/P1
           IF P2 = 1.0  PERFORM GOOD ELSE PERFORM BAD.
           COMPUTE Z2 = Z1/Z1
           IF Z2 = 1.0  PERFORM GOOD ELSE PERFORM BAD.
           DISPLAY 'TOTAL GOOD = ' GOOD ' TOTAL BAD = ' BAD
           STOP RUN.
       GOOD.
           DISPLAY 'GOOD-TEST'
           ADD 1 TO GOOD.
       BAD.
           DISPLAY 'BAD-TEST'
           MOVE 16 TO RETURN-CODE
           ADD 1 TO BAD.
